<{extends file="<{$tempdir}>/public/shopcenter.html"}>
<{block name=bodylist}>
<script src="<{$siteurl}>/templates/<{$tempdir}>/public/js/datepicker/WdatePicker.js" type="text/javascript" language="javascript"></script>
<script>
    var mynomenu='home';
</script>
<!--content right start-->
<style>
    .ibox-content{min-height: inherit;margin-bottom: 0;padding: 15px 20px 20px;}
    input,button,textarea{font-family:'Microsoft YaHei',Arial,Helvetica,sans-serif;}

    .homeList li{float: left;width: 23.5%;}
    .homeList li:not(:last-child){margin-right: 2%;}
    .label {font-size:10px; font-weight:600; padding:1px 8px; text-shadow:none; border-radius: .25em; }
    .pull-right { float: right!important; }
    .label-primary {background-color:#1ab394;color:#FFF }
    .label-success { background-color:#1c84c6; color:#FFF }
    .label-danger { background-color:#ed5565; color:#FFF }
    .label-info {background-color:#23c6c8; color:#FFF }
    .no-margins{margin: 0 0 5px;font-size: 30px;font-weight: 100;}
    .small,small { font-size: 85%; }
    .text-navy {color:#1ab394 }
    .text-success { color:#1c84c6 }
    .text-info { color:#23c6c8 }
    .text-danger {color:#ed5565}
    .font-bold{font-weight: 600;font-size: 14px;}
    .mart25{margin-top: 25px;}
    .mart15{margin-top: 15px;}
    .marl20{margin-left: 20px;}
    .dataTitle{font-size: 14px;font-weight: 600;margin-right: 15px;}
    .data_tj li{padding: 15px 0;}
    .data_tj li:not(:last-child){border-right: 1px solid #ddd;}
    .data_tj_t{font-size: 24px;font-weight: 100;}
    .type_pie li{width: 49%;float: left;}
    .type_pie li:not(:last-child){margin-right: 2%;}
    #orderType,#payStyle{height: 350px;}

    .cssBox{ display: -moz-box; display: -webkit-box; display:box; display: -ms-flexbox; }
    .flex{ -moz-box-flex:1; -webkit-box-flex:1; box-flex:1; -ms-flex:1;}
     .rankBox{width: 100%;height: 500px;overflow: hidden;margin: 50px 0;}
    .leftStat{width: 80%;height: 100%;float: left;border: 1px solid #ddd;box-sizing: border-box;overflow: hidden;}
    .rankRight{width:18%;height: 100%;float: right;border: 1px solid #ddd;box-sizing: border-box;background:#fff;}
    .rankRight h2{font-weight: normal;padding:0 10px;text-align:center;color:red;}
    .rankList{overflow: hidden;}
    .rankList .rankLiut{margin-bottom:16px;padding-left:20px;}
     .rankList .rankLiut span{width:26%;display:inline-block;text-align:center;margin:0 auto;}

    .rankList .rankLiut span .rankNum{width:20px;height:20px;background:#FF4500;border-radius:50%;display: inline-block;line-height:20px;color:#fff;text-align:center;}
    .rankList .rankLiut .rankName{color:#27A9E3;}


    .key_tab{    width: 200px;
    height: 33px;
    position: absolute;
    top:40px;
    right: 200px;
}
 .key_tab .tab_item{line-height:33px;padding:6px;background:#27A9E3;color:#fff;margin:0;}
 .key_tab .tab_active{background:#ED5565;}
</style>
<div class="conWaiSet" style="margin-bottom: 150px;">
      <div class="key_tab">
        <a href="<{ofunc type=url link="/shopcenter/midRewardStatistics/dateType/today"}>" <{if $dateType=='today'}> class="tab_item tab_active" <{else}>class="tab_item" <{/if}>>今天</a>
        <a href="<{ofunc type=url link="/shopcenter/midRewardStatistics/dateType/week"}>" <{if $dateType=='week'}> class="tab_item tab_active" <{else}>class="tab_item" <{/if}>>近7天</a>
        <a href="<{ofunc type=url link="/shopcenter/midRewardStatistics/dateType/month"}>" <{if $dateType=='month'}> class="tab_item tab_active" <{else}>class="tab_item" <{/if}>>近30天</a>
    </div>
    <!--a-->
    <ul class="homeList clearfix">
        <li>
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    
                    <h5>点评次数</h5>
                </div>
                <div class="ibox-content">
                    <div class="no-margins"><{$Zdianzan}></div>
                </div>
            </div>
        </li>
        <li>
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    
                    <h5>赏金收入</h5>
                </div>
                <div class="ibox-content">
                    <div class="no-margins"><{$Ztotal}></div>
                    
                </div>
            </div>
        </li>
        
        <li>
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    
                    <h5>浏览次数</h5>
                </div>
                <div class="ibox-content">
                    <div class="no-margins"><{$Zviews}></div>
                </div>
            </div>
        </li>
    </ul>


      <!--统计/排行-->
    <div class="rankBox">
        <!--统计图-->
        <div class="leftStat">
            <div id="container" style="width: 100%;height: 100%;"></div>
        </div>
        <!--排行-->
        <div class="rankRight">
            <h2 class="text-align">打赏排行榜Top10</h2>
            <ul class="rankList">
                <li class="rankLiut">
                    <span>排名</span>
                    <span>员工</span>
                    <span>赏金</span>
                </li>
                <{foreach from=$xiaoer item=info key="k"}>
                    <li class="rankLiut">
                        <span><i class="rankNum"><{$k+1}></i></span>
                        <span class="rankName"><{$info.operator}></span>
                        <span class="rankMoney"><{$info.tfee}>元</span>
                    </li>
                <{/foreach}>
            </ul>
      <!--       <{if count($xiaoer) > 10}>
            <a href="moreReward.html" class="text-align" style="display: block;margin-top: 7px;color: #7CB5EC;">查看更多</a>
            <{/if}>       -->            
        </div>
    </div>




    <!--数据列表-->
    <div class="ibox float-e-margins mart25">
        <div class="ibox-title">
            <h5>数据列表</h5>
        </div>
        <div class="ibox-content">
            <div class="mart15">
                <div class="search_content">
                    <form method="post" name="form1" action="<{ofunc type=url link="/shopcenter/midRewardStatistics"}>">
                        <span class="dataTitle">时间范围</span>             
                         <input class="datefmt form-control" type="text" name="StartDate" id="StartDate" value="<{$StartDate}>"  onFocus="WdatePicker({isShowClear:false,readOnly:true});" />
                        到
                        <input class="datefmt form-control" type="text" name="EndDate" id="EndDate" value="<{$EndDate}>"  onFocus="WdatePicker({isShowClear:false,readOnly:true});" />
                        <input type="submit" value="提交查询"  id = 'tj' class="btn-a btn-prim marl20">
               <!--          <input type="button" value="发送今日销售统计" id ='today' class="btn-a label-danger marl20"> -->
                    </form>
                </div>
            </div>
            <table class="table table-bordered mart25">
                <thead>
                <tr>
                    <th>点赞人/打赏人</th>
                    <th>员工</th>
                    <th>点评</th>
                    <th>评分(平均分)</th>
                    <th>赏金(总)</th>
               <!--      <th>时间</th> -->
                </tr>
                </thead>
                <tbody>
                <{foreach from=$xiaoer_cha item=xiaoer1}>
                <tr>
                    <td><{$xiaoer1.nickname}></td>
                    <td><{$xiaoer1.operator}></td>
                    <td><{$xiaoer1.comment}></td>
                    <td><{$xiaoer1.start}></td> 
                    <{if $xiaoer1.fee}>
                    <td><{$xiaoer1.fee}></td>
                    <{else}>
                    <td>0</td>
                    <{/if}>
                  <!--   <td><{$xiaoer1.time}></td> -->
                </tr>
                <{/foreach}>
                </tbody>
            </table>

        </div>
    </div>
</div>
<!--content right end-->
<script src="https://img.hcharts.cn/highcharts/highcharts.js"></script>
<script src="https://img.hcharts.cn/highcharts/highcharts-3d.js"></script>
<script>

      //切换按钮
    $('.key_tab .tab_item').click(function(){
       var i = $(this).index();
     
        $('.key_tab .tab_item').removeClass('tab_active').eq(i).addClass('tab_active')
    });

    $(function () {

        // $("#dateFrom").datepicker({
        //     setDate: new Date(),
        //     changeMonth: true,
        //     numberOfMonths: 1,
        //     onClose: function (selectedDate) {
        //         $("#dateTo").datepicker("option", "minDate", selectedDate);
        //     }
        // });
        // $("#dateTo").datepicker({
        //     changeMonth: true,
        //     numberOfMonths: 1,
        //     onClose: function (selectedDate) {
        //         $("#dateFrom").datepicker("option", "maxDate", selectedDate);
        //     }
        // });

        var dzArr = <{$dzjson}>;
        var totalArr = <{$totaljson}>;  
        var viewsArr = <{$viewsjson}>; 
      
        $('#container').highcharts({
            chart: {
                type: 'column'
            },
            credits:{
                enabled:false // 禁用版权信息
            },
            title: {
                text: '打赏统计'
            },
            subtitle: {
                text: 'Reward statistics'
            },
            xAxis: {
                categories: dzArr['dateList']
            },
            yAxis: {
                min: 0,
                title: {
                    text: ''
                }
            },
            tooltip: {
                headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                '<td style="padding:0"><b>{point.y:.1f}</b></td></tr>',
                footerFormat: '</table>',
                shared: true,
                useHTML: true
            },
            plotOptions: {
                column: {
                    pointPadding: 0.2,
                    borderWidth: 0
                }
            },
            series: [{
                name: '点评次数',
                data: dzArr['data']

            }, {
                name: '赏金收入',
                data: totalArr['data']

            }, {
                name: '浏览次数',
                data: viewsArr['data']
            }]
        });
    });
 
function getNowFormatDate() {
    var date = new Date();
    var seperator1 = "-";
    var seperator2 = ":";
    var year = date.getFullYear();
    var month = date.getMonth() + 1;
    var strDate = date.getDate();
    if (month >= 1 && month <= 9) {
        month = "0" + month;
    }
    if (strDate >= 0 && strDate <= 9) {
        strDate = "0" + strDate;
    }
    var currentdate = year + seperator1 + month + seperator1 + strDate;
    //var predata     = year + seperator1 + month + seperator1 + (strDate-1);
    return currentdate;
}

</script>
<{/block}>